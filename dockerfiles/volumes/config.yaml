################################################################################
# Licensed to the OpenAirInterface (OAI) Software Alliance under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The OpenAirInterface Software Alliance licenses this file to You under
# the OAI Public License, Version 1.1  (the "License"); you may not use this file
# except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.openairinterface.org/?page_id=698
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#-------------------------------------------------------------------------------
# For more information about the OpenAirInterface (OAI) Software Alliance:
#      contact@openairinterface.org
################################################################################

# OAI CN Configuration File
### This file can be used by all OAI NFs
### Some fields are specific to an NF and will be ignored by other NFs

############# Common configuration

# Log level for all the NFs
log_level:
  general: debug

# If you enable registration, the other NFs will use the NRF discovery mechanism
register_nf:
  general: yes

http_version: 2

############## SBI Interfaces
### Each NF takes its local SBI interfaces and remote interfaces from here, unless it gets them using NRF discovery mechanisms
nfs:
  amf:
    host: 192.168.71.132
    sbi:
      port: 8080
      api_version: v1
      interface_name: amf-sw1
    n2:
      interface_name: amf-sw1
      port: 38412
  smf:
    host: 192.168.71.133
    sbi:
      port: 8080
      api_version: v1
      interface_name: smf-sw1
    n4:
      interface_name: smf-sw1
      port: 8805
  upf:
    host: 192.168.71.134
    sbi:
      port: 8080
      api_version: v1
      interface_name: upf-core
    n3:
      interface_name: upf-core
      port: 2152
    n4:
      interface_name: upf-core
      port: 8805
    n6:
      interface_name: upf-ext_dn
    n9:
      interface_name: upf-core
      port: 2152
  spgwu:
    host: 192.168.71.134
    sbi:
      port: 8080
      api_version: v1
      interface_name: spgwu-sw1
  udm:
    host: 192.168.71.136
    sbi:
      port: 8080
      api_version: v1
      interface_name: udm-sw1
  udr:
    host: 192.168.71.137
    sbi:
      port: 8080
      api_version: v1
      interface_name: udr-sw1
  ausf:
    host: 192.168.71.138
    sbi:
      port: 8080
      api_version: v1
      interface_name: ausf-sw1
  nrf:
    host: 192.168.71.130
    sbi:
      port: 9090
      api_version: v1
      interface_name: nrf-sw1
  pcf:
    host: 192.168.71.139
    sbi:
      port: 8080
      api_version: v1
      interface_name: pcf-sw1
  nssf:
    host: 192.168.71.135
    sbi:
      port: 8080
      api_version: v1
      interface_name: nssf-sw1

#### Common for UDR and AMF
database:
  host: 192.168.71.131
  user: test
  type: mysql
  password: test
  database_name: oai_db
  generate_random: true
  connection_timeout: 300 # seconds

## general single_nssai configuration
## Defines YAML anchors, which are reused in the config file
snssais:
  - &embb_slice1
    sst: 1
    sd: 000001
  - &embb_slice2
    sst: 1
    sd: 000002  # in hex
  - &urllc_slice
    sst: 2 
    sd: 000001  # in hex

############## NF-specific configuration
amf:
  pid_directory: "/var/run"
  amf_name: "OAI-AMF"
  # This really depends on if we want to keep the "mini" version or not
  support_features_options:
    enable_simple_scenario: no
    enable_nssf: yes
    enable_smf_selection: yes
    #use_external_udm: yes 
  relative_capacity: 30
  statistics_timer_interval: 20  #in seconds
  emergency_support: false
  served_guami_list:
    - mcc: 208
      mnc: 95
      amf_region_id: 01
      amf_set_id: 001
      amf_pointer: 01
    - mcc: 001
      mnc: 01
      amf_region_id: 01
      amf_set_id: 001
      amf_pointer: 01
  plmn_support_list:
    - mcc: 208 
      mnc: 95
      tac: 0x0001
      nssai:
        - *embb_slice1
        - *embb_slice2
        - *urllc_slice
  supported_integrity_algorithms:
    - "NIA0"
    - "NIA1"
    - "NIA2"
  supported_encryption_algorithms:
    - "NEA0"
    - "NEA1"
    - "NEA2"

smf:
  ue_mtu: 1500 # 1500
  support_features: 
    use_local_subscription_info: no # Use infos from local_subscription_info or from UDM
    use_local_pcc_rules: no # Use infos from local_pcc_rules or from PCF
  # we resolve from NRF, this is just to configure usage_reporting
  # upfs:
  #   - host: 192.168.71.134
  #     port: 8805
  #     config:
  #       enable_usage_reporting: yes
  #       enable_dl_pdr_in_pfcp_session_establishment: no
  #     upf_info:
  #       interfaceUpfInfoList:
  #         - interfaceType: N3
  #           networkInstance: 192.168.71.134
  #         - interfaceType: N4
  #           networkInstance: 192.168.71.134
  #         - interfaceType: N6
  #           networkInstance: 192.168.71.134
  ue_dns:
    primary_ipv4: "8.8.8.8"
    primary_ipv6: "2001:4860:4860::8888"
    secondary_ipv4: "1.1.1.1"
    secondary_ipv6: "2001:4860:4860::8888"
  #ims:
  #  pcscf_ipv4: "8.8.8.8"
  smf_info:
    sNssaiSmfInfoList:
      - sNssai: *embb_slice1
        dnnSmfInfoList:
          - dnn: "oai"
      - sNssai: *embb_slice2
        dnnSmfInfoList:
          - dnn: "oai.2"
      - sNssai: *urllc_slice
        dnnSmfInfoList:
          - dnn: "oai.3"

  # the DNN you configure here should be configured in "dnns"
  local_subscription_infos:
    - single_nssai: *embb_slice1
      dnn: "oai"
      qos_profile:
        5qi: 9
        session_ambr_ul: "1Mbps"
        session_ambr_dl: "2Mbps"
    - single_nssai: *embb_slice2
      dnn: "oai.2"
      qos_profile:
        5qi: 9
        session_ambr_ul: "2Mbps"
        session_ambr_dl: "3Mbps"
    - single_nssai: *urllc_slice
      dnn: "oai.3"
      qos_profile:
        5qi: 86
        session_ambr_ul: "3Mbps"
        session_ambr_dl: "1Mbps"

upf:
  support_features:
    enable_bpf_datapath: off    # If "on": BPF is used as datapath else simpleswitch is used, DEFAULT= off
    enable_qos: off  # Only supported for BPF datapath. If "on" we use qdiscs to manage the QoS
    enable_snat: off           # If "on": Source natting is done for UE, DEFAULT= off
  #config:
  #  enable_usage_reporting: yes
  #  enable_dl_pdr_in_pfcp_session_establishment: yes
  remote_n6_gw: 192.168.72.135      # Dummy host since simple-switch does not use N6 GW
  #smfs:
  #  - host: 192.168.71.133
  upf_info:
    sNssaiUpfInfoList:
      - sNssai: *embb_slice1
        dnnUpfInfoList:
          - dnn: "oai"
      - sNssai: *embb_slice2
        dnnUpfInfoList:
          - dnn: "oai.2"
      - sNssai: *urllc_slice
        dnnUpfInfoList:
          - dnn: "oai.3"

## DNN configuration
dnns:
  - dnn: "oai"
    pdu_session_type: "IPV4"
    ipv4_subnet: "12.1.1.0/24"
  - dnn: "oai.2"
    pdu_session_type: "IPV4"
    ipv4_subnet: "13.1.1.0/24"
  - dnn: "oai.3"
    pdu_session_type: "IPV4"
    ipv4_subnet: "14.1.1.0/24"
nrf:
  heartbeat: 10 # in seconds
  suspended_nf_interval: 20 # in seconds
pcf:
  local_policy:
    policy_decisions_path: /openair-pcf/policies/policy_decisions
    pcc_rules_path: /openair-pcf/policies/pcc_rules
    traffic_rules_path: /openair-pcf/policies/traffic_rules

nssf:
  slice_config_path: /openair-nssf/etc/nssf_slice_config.yaml
